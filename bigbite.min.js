javascript:!function(){var e,t,n,i=!1,r={};const o="BigBiteSelected";for(var a,l=function(e){e.stopPropagation(),e.preventDefault()},s=function(){for(var i in r){var o=y(i);c(o.x,o.y)}e=t=n=null,r={}},d=function(e,t,n){for(var i={x:e.x<=t.x?e.x:t.x,y:e.y<=t.y?e.y:t.y},r={x:e.x>t.x?e.x:t.x,y:e.y>t.y?e.y:t.y},o=i.y;o<=r.y;o++)for(var a=i.x;a<=r.x;a++){var l=f(a,o);n[l]?delete n[l]:n[l]=l}},c=function(t,n){e.rows[n].cells[t].classList.remove(o)},u=function(e){for(var t,n={},i=e.target;i;){switch(t=i.nodeName.toLowerCase()){case"th":t="td";case"td":case"tr":case"table":if(n[t]=i,"table"===t)return n}i=i.parentNode}return n},f=function(e,t){return t+"-"+e},y=function(e){var t=e.split("-");return{x:+t[1],y:+t[0]}},v=function(a){if(a.ctrlKey&&1===a.which){var v=u(a);if(v.table&&(l(a),a.currentTarget.defaultView.getSelection().removeAllRanges()),v.td){if(e){if(e!==v.table)return s(),void l(a)}else e=v.table;var x={x:v.td.cellIndex,y:v.tr.rowIndex},m=f(x.x,x.y);if(n!==m&&!i){i=!0,null==t&&(t=m);var p=y(t),w={};n&&d(p,y(n),w),d(p,x,w);for(id in w){var g=y(id);r[id]?(delete r[id],c(g.x,g.y)):(r[id]=1,e.rows[g.y].cells[g.x].classList.add(o))}n=m,i=!1}}}},x=function(e,t){return e.y===t.y?e.x-t.x:e.y-t.y},m=function(t){if(r){var n=[];for(var i in r)n[n.length]=y(i);n.sort(x);for(var o,a,d=[],c=0,u=0,f=0;a=n[f];f++)null==o&&(o=a.y),o!==a.y&&(o=a.y,c++,u=0),d[c]||(d[c]=[]),d[c][u++]=e.rows[a.y].cells[a.x].textContent.trim();for(var v,m="",f=0;v=d[f];f++)m+=v.join("\t")+"\r\n";t.clipboardData.setData("text",m.slice(0,-2)),s(),l(t)}},p=function(e){return 1===e.which?e.ctrlKey?v(e):(s(),void e.stopPropagation()):void 0},w=function(e){(t||n)&&(t=n=null,l(e))},g=function(e,t){if(!e.BigBite||!e.BigBite.init){e.BigBite={init:!0},t.addEventListener("mouseup",w,!0),t.addEventListener("mousedown",p,!0),t.addEventListener("mousemove",v,!0),t.addEventListener("copy",m,!0);var n=t.createElement("style");n.type="text/css",t.getElementsByTagName("head").item(0).appendChild(n),n.sheet.insertRule(".BigBiteSelected{box-shadow:-2px -1px blue inset}",0)}},h=0;a=window.frames[h];h++)a.addEventListener("load",function(){g(this,this.document)}),g(a,a.document);g(window,document)}();
