javascript:!function(){for(var e,t,n,i,r=!1,a={},o=function(e){e.stopPropagation(),e.preventDefault()},s=function(){for(var i in a){var r=v(i);d(r.x,r.y)}e&&e.classList.remove("BigBiteUnselectable"),e=t=n=null,a={}},l=function(e,t,n){for(var i={x:e.x<=t.x?e.x:t.x,y:e.y<=t.y?e.y:t.y},r={x:e.x>t.x?e.x:t.x,y:e.y>t.y?e.y:t.y},a=i.y;a<=r.y;a++)for(var o=i.x;o<=r.x;o++){var s=f(o,a);n[s]?delete n[s]:n[s]=s}},c=function(i){var o=f(i.x,i.y);if(n!==o&&!r){r=!0,null==t&&(t=o);var s=v(t),c={};n&&l(s,v(n),c),l(s,i,c);for(id in c){var u=v(id);if(a[id])delete a[id],d(u.x,u.y);else{var x=e.rows[u.y].cells[u.x];a[id]=x.textContent,x.classList.add("BigBiteSelected")}}n=o,r=!1}},d=function(t,n){e.rows[n].cells[t].classList.remove("BigBiteSelected")},u=function(e){for(var t={},n=e.target;n;){switch(name=n.nodeName.toLowerCase()){case"th":name="td";case"td":case"tr":case"table":if(t[name]=n,"table"===name)return t}n=n.parentNode}return t},f=function(e,t){return t+"-"+e},v=function(e){var t=e.split("-");return{x:+t[1],y:+t[0]}},x=function(e){return e.tr.rowIndex},y=function(e){return e.td.cellIndex},B=function(t){if(t.ctrlKey&&1===t.which){var n=u(t);if(n.td){if(e){if(e!=n.table)return s(),void o(t)}else e=n.table,e.classList.add("BigBiteUnselectable");o(t),c({x:y(n),y:x(n)})}}},m=function(e){if(a){var t=[];for(var n in a)t[t.length]=n;t.sort();for(var i,r,l=[],c=0,d=0,u=0;r=t[u];u++){var f=v(r).y;null==i&&(i=f),i!=f&&(i=f,c++,d=0),l[c]||(l[c]=[]),l[c][d++]=a[r].trim()}for(var x,y="",u=0;x=l[u];u++)y+=x.join("\t")+"\r\n";e.clipboardData.setData("text",y.slice(0,-2)),s(),o(e)}},g=function(e){return 1===e.which?e.ctrlKey?B(e):(s(),void e.stopPropagation()):void 0},h=function(e){(t||n)&&(t=n=null,o(e))},p=function(e,t){if(!e.BigBite||!e.BigBite.init){e.BigBite={init:!0},t.addEventListener("mouseup",h,!0),t.addEventListener("mousedown",g,!0),t.addEventListener("mousemove",B,!0),t.addEventListener("copy",m,!0);var n=t.createElement("style");n.type="text/css",t.getElementsByTagName("head").item(0).appendChild(n),n.sheet.insertRule("table.BigBiteUnselectable{-webkit-user-select:none}",0),n.sheet.insertRule("th.BigBiteSelected,td.BigBiteSelected{box-shadow:-2px -1px blue inset}",0)}},w=0;i=window.frames[w];w++)i.addEventListener("load",function(){p(this,this.document)}),p(i,i.document);p(window,document)}();
